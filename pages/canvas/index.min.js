"use strict";var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),x=100,y=100,z=100;canvas.setAttribute("width",canvas.parentElement.offsetWidth);var points=[[0,0],[x,0],[x,-y],[0,-y],[z*Math.cos(45*Math.PI/180),-z*Math.sin(45*Math.PI/180)],[z*Math.cos(45*Math.PI/180),-y-z*Math.sin(45*Math.PI/180)],[x+z*Math.cos(45*Math.PI/180),-z*Math.sin(45*Math.PI/180)],[x+z*Math.cos(45*Math.PI/180),-y-z*Math.sin(45*Math.PI/180)]],faces=[[points[4],points[5],points[7],points[6]],[points[0],points[4],points[6],points[1]],[points[0],points[3],points[5],points[4]],[points[1],points[2],points[7],points[6]],[points[2],points[3],points[5],points[7]],[points[0],points[3],points[2],points[1]]];function draw(t,a,n){ctx.save(),ctx.translate(t,a);for(var s=0,i=faces.length;s<i;s++){var e=faces[s];ctx.beginPath();for(var h=0,r=e.length;h<r;h++)0==h?ctx.moveTo(e[h][0],e[h][1]):ctx.lineTo(e[h][0],e[h][1]);ctx.closePath(),n?(ctx.fillStyle=randC(.8),ctx.fill()):ctx.stroke()}ctx.restore()}function randC(t){return"rgba("+~~(255*Math.random())+","+~~(255*Math.random())+","+~~(255*Math.random())+","+(t||1)+")"}draw(0,300),draw(300,300,!0);var canvas1=document.getElementById("canvas1"),graphs=[],graphAttr=[{x:60,y:60,w:100,h:100,bgColor:randC(.8),canvasObj:canvas1},{x:350,y:120,w:50,h:50,bgColor:randC(.8),canvasObj:canvas1,shape:"circle"},{x:200,y:130,w:70,h:70,bgColor:randC(.8),canvasObj:canvas1,shape:"triangle"}],tempGraphArr=[];canvas1.setAttribute("width",canvas1.parentElement.offsetWidth),dragGraph=function(t,a,n,s,i,e,h){this.x=t,this.y=a,this.w=n,this.h=s,this.fillStyle=i,this.canvas=e,this.context=e.getContext("2d"),this.canvasPos=e.getBoundingClientRect(),this.graphShape=h},dragGraph.prototype={paint:function(){this.context.beginPath(),this.context.fillStyle=this.fillStyle,this.shapeDraw(),this.context.fill(),this.context.closePath()},isMouseInGraph:function(t){return this.context.beginPath(),this.shapeDraw(),this.context.isPointInPath(t.x,t.y)},shapeDraw:function(){"circle"==this.graphShape?this.context.arc(this.x,this.y,50,0,2*Math.PI):"triangle"==this.graphShape?(this.context.moveTo(this.x+50,this.y+50),this.context.lineTo(this.x+100,this.y+130),this.context.lineTo(this.x,this.y+130)):this.context.rect(this.x,this.y,this.w,this.h)},erase:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}},canvas1.addEventListener("mousedown",function(t){var a={x:t.clientX-canvas1.getBoundingClientRect().left,y:t.clientY-canvas1.getBoundingClientRect().top};graphs.forEach(function(t){var n=a.x-t.x,s=a.y-t.y;t.isMouseInGraph(a)&&(tempGraphArr.push(t),canvas1.addEventListener("mousemove",function(i){a={x:i.clientX-canvas1.getBoundingClientRect().left,y:i.clientY-canvas1.getBoundingClientRect().top},t===tempGraphArr[tempGraphArr.length-1]&&(t.x=a.x-n,t.y=a.y-s,t.erase(),drawGraph())},!1),canvas1.addEventListener("mouseup",function(){tempGraphArr=[]},!1))}),t.preventDefault()},!1);for(var i=0;i<graphAttr.length;i++){var graph=new dragGraph(graphAttr[i].x,graphAttr[i].y,graphAttr[i].w,graphAttr[i].h,graphAttr[i].bgColor,graphAttr[i].canvasObj,graphAttr[i].shape);graphs.push(graph)}function drawGraph(){for(var t=0;t<graphAttr.length;t++)graphs[t].paint()}drawGraph();